{% extends "base.html" %}

{% block title %}{{ texts.contact }} - {{ texts.name }}{% endblock %}

{% block content %}

<style>
    /* ========================================= */
    /* 1. MODAL (BİLDİRİM KUTUSU) AYARLARI       */
    /* ========================================= */
    #flash-modal.modal-overlay {
        display: none; /* JS ile flex yapılacak */
        position: fixed !important;
        top: 0 !important;
        left: 0 !important;
        width: 100vw !important;
        height: 100vh !important;
        background: rgba(0, 0, 0, 0.9) !important;
        z-index: 2147483647 !important; /* En üst katman */
        justify-content: center !important;
        align-items: center !important;
        backdrop-filter: blur(8px) !important;
    }

    #flash-modal .modal-content {
        background: #1e1e1e !important;
        border: 2px solid #00d9ff !important;
        padding: 40px !important;
        border-radius: 20px !important;
        text-align: center !important;
        max-width: 450px !important;
        width: 90% !important;
        box-shadow: 0 0 50px rgba(0, 217, 255, 0.5) !important;
        display: flex !important;
        flex-direction: column !important;
        align-items: center !important;
        gap: 20px !important;
    }

    #flash-modal #modal-message {
        color: #ffffff !important;
        font-size: 1.3rem !important;
        font-weight: 500 !important;
        margin: 10px 0 !important;
        display: block !important;
    }

    #flash-modal .success-icon {
        color: #2ecc71 !important;
        font-size: 4rem !important;
    }

    #flash-modal .error-icon {
        color: #e74c3c !important;
        font-size: 4rem !important;
    }

    #flash-modal .btn {
        margin-top: 15px !important;
        min-width: 120px !important;
        cursor: pointer !important;
        background: #00d9ff !important;
        border: none !important;
        padding: 10px 20px !important;
        color: white !important;
        border-radius: 5px !important;
    }

    /* ========================================= */
    /* 2. CHATBOT SABİTLEME (SCROLL) AYARLARI    */
    /* ========================================= */

    /* Ana Kutu: Boyutu kilitliyoruz */
    #chatbot-container.chatbot-container {
        width: 100% !important;
        max-width: 400px !important;
        /* YÜKSEKLİK KİLİDİ */
        height: 500px !important;
        max-height: 500px !important;
        background: #1e1e1e !important;
        border: 1px solid #00d9ff !important;
        border-radius: 10px !important;
        display: flex !important;
        flex-direction: column !important; /* Alt alta diz */
        overflow: hidden !important; /* Dışarı taşanı gizle */
        box-shadow: 0 0 20px rgba(0, 217, 255, 0.1) !important;
    }

    /* Başlık */
    .chatbot-header {
        background: #00d9ff !important;
        padding: 15px !important;
        color: white !important;
        text-align: center !important;
        font-weight: bold !important;
        flex-shrink: 0 !important; /* Sıkışmayı önle */
    }

        .chatbot-header p {
            margin: 0 !important;
        }

    /* Mesaj Alanı: Burası kaydırılabilir olacak */
    #chatbot-messages.chatbot-messages {
        flex: 1 !important; /* Kalan tüm alanı kapla */
        padding: 15px !important;
        /* Scroll Ayarı */
        overflow-y: auto !important;
        min-height: 0 !important;
        display: flex !important;
        flex-direction: column !important;
        gap: 10px !important;
    }

    /* Input Alanı */
    #chatbot-form.chatbot-input-form {
        display: flex !important;
        border-top: 1px solid #333 !important;
        flex-shrink: 0 !important; /* Aşağı itilip kaybolmasın */
        background: #1e1e1e !important;
        padding: 0 !important;
        margin: 0 !important;
    }

    #chatbot-input {
        flex: 1 !important;
        background: transparent !important;
        border: none !important;
        padding: 15px !important;
        color: white !important;
        outline: none !important;
    }

    #chatbot-form button {
        background: #00d9ff !important;
        border: none !important;
        padding: 0 20px !important;
        color: white !important;
        cursor: pointer !important;
    }

    /* Kaydırma Çubuğu Güzelleştirme */
    .chatbot-messages::-webkit-scrollbar {
        width: 8px;
    }

    .chatbot-messages::-webkit-scrollbar-thumb {
        background: #00d9ff;
        border-radius: 4px;
    }

    .chatbot-messages::-webkit-scrollbar-track {
        background: #121212;
    }
</style>

<section class="contact-section">
    <div class="contact-wrapper">

        <div class="contact-left">
            <h3>{{ texts.contactFormTitle }}</h3>
            <form action="{{ url_for('contact') }}" method="POST" class="contact-form">
                <div class="form-group">
                    <input type="text" name="name" placeholder="{{ texts.formName }}" required>
                    <input type="email" name="email" placeholder="{{ texts.formEmail }}" required>
                </div>
                <div class="form-group">
                    <textarea name="message" placeholder="{{ texts.formMessage }}" required></textarea>
                </div>
                <button type="submit" class="btn">{{ texts.formSend }}</button>
            </form>

            <div class="divider"><span>{{ texts.or }}</span></div>

            <h3>{{ texts.contactSocialTitle }}</h3>
            <div class="social-contact">
                <a href="https://www.linkedin.com/in/vedat-koylahisar-98790b238/" target="_blank" class="social-link linkedin">
                    <i class="fab fa-linkedin-in"></i><span>LinkedIn</span>
                </a>
                <a href="https://github.com/vedatkoylahisar" target="_blank" class="social-link github">
                    <i class="fab fa-github"></i><span>GitHub</span>
                </a>
                <a href="mailto:vedatkylhsr@gmail.com" class="social-link email">
                    <i class="fas fa-envelope"></i><span>Email</span>
                </a>
            </div>
        </div>

        <div class="contact-right">
            <div class="chatbot-container" id="chatbot-container">
                <div class="chatbot-header"><p>{{ texts.chatbotTitle }}</p></div>
                <div class="chatbot-messages" id="chatbot-messages">
                    <div class="message bot-message"><p>{{ texts.chatbotContactIntro }}</p></div>
                </div>
                <form class="chatbot-input-form" id="chatbot-form">
                    <input type="text" id="chatbot-input" placeholder="{{ texts.chatbotPlaceholder }}" autocomplete="off">
                    <button type="submit"><i class="fas fa-paper-plane"></i></button>
                </form>
            </div>
        </div>

    </div>
</section>

<div id="flash-modal" class="modal-overlay">
    <div class="modal-content">
        <div id="modal-icon"></div>
        <p id="modal-message"></p>
        <button onclick="closeModal()" class="btn">Tamam</button>
    </div>
</div>

{% with messages = get_flashed_messages(with_categories=true) %}
  {% if messages %}
<script>
      window.addEventListener('load', function() {
        setTimeout(function() {
            {% for category, message in messages %}
              if (typeof showModal === "function") {
                console.log("Modal tetikleniyor: {{ message }}");
                showModal("{{ message }}", "{{ category }}");
              } else {
                alert("Mesajınız gönderildi: {{ message }}");
              }
            {% endfor %}
        }, 500);
      });
</script>
  {% endif %}
{% endwith %}

{% endblock %}